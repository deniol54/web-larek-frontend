# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом
- src/types/ — папка с типами

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Архитектура

В качестве архитектуры для проекта за основу взят паттерн MVC.
Реализована единая модель данных приложения в файле src/components/model/ShopState.ts, содержащая всю логику работы с данными и возможные действия над ними. Все изменения данных происходят через методы модели, а она в свою очередь уведомляет об изменениях через метод настроек onChange(changes: AppStateChanges). Подключение модели к системе событий производится через обертку src/components/model/AppStateEmitter.ts.

Экземпляр модели передается в контроллеры, которые по факту являются обработчиками пользовательских действий и обновляют состояние модели через ее методы.

При обработке событий возникающих в AppStateEmitter производится обновление данных в отображениях. 

### Данные (Модели)

1. Класс Product
Сожержит в себе описание товаров, находящтхся на странице магазина.

Поля:
- productId - ID товара на сервере, 
- productType - категория товара,
- productTitle - название товара,
- productImage - ссылка на картинку товара,
- productPrice - цена товара,
- productDescription - описание товара

2. Класс UserData
Содержит в себе информацию пользователя необходимую для осуществления заказа.

Поля:
- email - электронная почта,
- phoneNumber - номер телефона,
- address - адрес,
- payType - тип оплаты

Методы:
- reset - сброс всех полей,
- сеттеры для каждого из полей класса

3. Класс ProductBasket
Содержит себе информацию о корзине с покупками.

Поля:
- products - товары, находящиеся в корзине,
- basketPrice - общая стоимость товаров в корзине,
- basketCount - количество товаров в корзине

Методы:
- addProduct - добавить товар в корзину,
- removeProduct - удалить товар из корзины,
- reset - очистить корзину,
- getListOfProducts - получить список товаров из корзины,
- геттер для basketPrice,
- геттер для basketCount

4. Класс Catalog
Класс для описания каталога товаров на странице.

Поля:
- products - список товаров

Методы:
- fillCatalog - заполнить каталог товарами,
- getCatalog - получить товары, находящиеся в каталоге

5. Класс IShopAPI 
Класс для взаимодействия с API сервера

Методы:
- getProducts - получить все товары с сервера,
- getCertainProduct - получить описание товара по его ID,
- orderProducts - сделать заказ

6. Класс Order
Класс описывающий заказ, содержит данные пользователя и список заказываемых продуктов.

Поля:
- Все поля реализованные в классе UserData,
- products - список товаров в заказе


7. Класс OrderResult
Класс для описания результата заказа. Содержит уникальный идентификатор заказа и сумму закза.

Поля:
- id - идентификотор заказа,
- total - сумма заказа

8. Класс ShopState
Класс, описывающий состояние магазина. 

Поля:
- catalog - католог товаров на странице,
- basket - корзина,
- userData - данные пользователя для заказа,
- basketTotal - колчество товаров в корзине,
- order - данные о заказе для отправки на сервер,
- openedModal - информация об открытых модальных окнах на странице,
- isOrderReady - готовность заказа,
- modalMessage - сообщение об ошибке,
- isError - есть ли ошибка при валидации формы

Методы:
- loadProducts - загрузка товаров с сервера,
- orderProducts- заказ товаров,
- selectProduct - выбрать товар,
- removeProduct - удалить товар из корзины,
- fillUserData - заполнение данных пользователя для заказа,
- isValidContacts - проверка валидноти заполненных данных,
- openModal - открыть модальное окно,
- setMessage - вывести сообщение об ошибке


### Отображение

Отображения в проекте разделены на три типа:

- common — общие компоненты, не зависящие от доменной области проекта
- partial — частичные компоненты, реализующие доменную область проекта
- screen — верхнеуровневые компоненты, которые являются экранами приложения

Создание компонентов для отображение происходит через класс IView, который является дженериком и принимает в себя два типа: тип данных(значения для вывода) и тип настроек(селекторы для вставки данных).

Поля:
- element - корневой HTML элемент

Методы:
- copy - копирующий конструктор,
- render - метод рендера

### Контроллеры

Контроллеры являются обработчиками пользовательских действий и обновляют состояние модели через ее методы. Пользовательские действия, меняющие состояние приложения описаны в файле ShopState.ts
Список действий следующий:
- modal - открытие модальных окон,
- modalMessage - ошибка в валидации вводимых пользователем данных,
- selectedProduct - выбор продукта и добавление его в корзну,
- orederData - заполнение данных для заказа,
- basket - действия с корзиной,
- order - совершение заказа